apiVersion: constraints.gatekeeper.sh/v1beta1
kind: BlockExecAttach
metadata:
  name: block-all-exec-attach
spec:
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
    excludedNamespaces: []  # Apply to all namespaces
  parameters:
    allowedUsers: 
      - "system:admin"
      - "system:masters"