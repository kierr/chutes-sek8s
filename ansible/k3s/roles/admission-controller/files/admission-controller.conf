[Service]
# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true

# Filesystem access
ReadWritePaths=/var/log/admission-controller /run/admission-controller
ReadOnlyPaths=/etc/admission-controller /opt/admission-controller

# Auto-create /run/admission-controller on service start
RuntimeDirectory=admission-controller
RuntimeDirectoryMode=0755
User=admission
Group=admission

# Kernel protection
ProtectKernelTunables=true
ProtectKernelModules=true
ProtectControlGroups=true
ProtectKernelLogs=true
ProtectClock=true

# Network restrictions
RestrictAddressFamilies=AF_INET AF_INET6 AF_UNIX
IPAddressDeny=any
IPAddressAllow=127.0.0.1 ::1

# Namespace restrictions
RestrictNamespaces=true
LockPersonality=true
MemoryDenyWriteExecute=true
RestrictRealtime=true
RestrictSUIDSGID=true
RemoveIPC=true

# System call filtering
SystemCallFilter=@system-service
SystemCallFilter=~@privileged @resources @reboot @swap @module @mount @clock @cpu-emulation @debug @keyring @ipc @raw-io @obsolete

# Device access
PrivateDevices=true
DevicePolicy=closed

# User/Group restrictions
SupplementaryGroups=
PrivateUsers=true

# Resource limits
LimitNOFILE=65536
MemoryMax=500M
CPUQuota=50%
TasksMax=100