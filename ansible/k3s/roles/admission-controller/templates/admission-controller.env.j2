# Admission Controller Environment Configuration
# This file is managed by Ansible

# Server Configuration
ADMISSION_BIND_ADDRESS='127.0.0.1'
ADMISSION_PORT={{ admission_port | default(8443) }}

# TLS Configuration
TLS_CERT_PATH=/etc/admission-controller/certs/server.crt
TLS_KEY_PATH=/etc/admission-controller/certs/server.key

# OPA Configuration
OPA_URL={{ opa_url | default('http://localhost:8181') }}
OPA_TIMEOUT={{ opa_timeout | default(5.0) }}
POLICY_PATH=/etc/opa/policies

# Registry Allowlist
ALLOWED_REGISTRIES={{ allowed_registries | default(['docker.io', 'gcr.io', 'quay.io', 'localhost:30500']) | to_json }}

# Cache Configuration
CACHE_ENABLED={{ cache_enabled | default(true) | lower }}
CACHE_TTL={{ cache_ttl | default(300) }}

# Enforcement Mode
ENFORCEMENT_MODE={{ enforcement_mode | default('enforce') }}

# Debug and Metrics
DEBUG={{ debug_mode | default(false) | lower }}
METRICS_ENABLED={{ metrics_enabled | default(true) | lower }}

# Config file override (optional)
CONFIG_FILE=/etc/admission-controller/config.json
