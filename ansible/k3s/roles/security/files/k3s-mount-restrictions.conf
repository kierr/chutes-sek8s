[Service]
# Filesystem protection
ProtectSystem=full
ProtectHome=yes
PrivateTmp=no
ReadWritePaths=/var /run /cache /etc/rancher /sys/fs/cgroup /etc/cni /var/lib/cni
ReadOnlyPaths=/usr /boot

# Mount restrictions
PrivateMounts=yes
MountFlags=slave

# Prevent new privileges
NoNewPrivileges=no  # k3s needs this for now, will restrict in containers

# Resource limits (optional)
TasksMax=infinity
LimitNOFILE=1048576
LimitNPROC=infinity

# Additional security
RestrictAddressFamilies=AF_UNIX AF_INET AF_INET6 AF_NETLINK
ProtectKernelTunables=yes
ProtectKernelModules=no
ProtectControlGroups=no
