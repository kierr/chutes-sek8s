---
- name: Security hardening
  tags: security
  vars:
    enable_module_signing: true
    attestation_endpoint: "https://api.example.com/attestation"
    attestation_interval: 900  # 15 minutes
    module_monitoring: true
  block:
    # - name: Module signing
    #   ansible.builtin.include_tasks: module-signing.yml
    #   tags: module-signing

    - name: Seccomp profiles
      ansible.builtin.include_tasks: seccomp-profiles.yml
      tags: seccomp-profiles
    
    # - name: Attestation integration
    #   ansible.builtin.include_tasks: attestation-integration.yml
    #   tags: attestation
    
    - name: Chroot and init hardening
      ansible.builtin.include_tasks: chroot-hardening.yml
      tags:
        - chroot-hardening
        - init-hardening

    - name: Disable cloud-init
      ansible.builtin.include_tasks: disable-cloud-init.yml
      tags:
        - chroot-hardening
        - init-hardening